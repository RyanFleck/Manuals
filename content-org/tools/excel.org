#+LAYOUT: docs-manual
#+title: Excel & VBA
#+SUMMARY: Enterprise grade spreadsheeting.
#+hugo_base_dir: ../../
#+hugo_section: tools
#+hugo_custom_front_matter: :toc true :summary "Enterprise grade spreadsheeting." :chapter true
#+hugo_custom_front_matter: :aliases '("/xlsx/" "/xlsm/" "/xls")
#+hugo_custom_front_matter: :warning "THIS FILE WAS GENERATED BY OX-HUGO, DO NOT EDIT!!!"
#+hugo_level_offset: 0

# SPECIAL EMACS ACTIONS FOR THIS FILE:
# ====================================
# - To export, type C-c C-e H A
# - To insert a clojuredocs link in clojure.core type C-c o c
# - To insert a clojuredocs link  type C-c o C

# Make sure you aren't using markdown footnotes in this file!

* Introduction

Man has always had the spreadsheet for working purposes.

Martin Shkreli has a [[https://www.youtube.com/watch?v=VI_riscmviI&list=PLJsVF3gZDcuTxcdH5FmQRTd6MiJ29X_OQ][Finance Lessons]] playlist[fn:1] with a focus on Excel.

#+begin_quote
"I'll create a GUI interface in Visual Basic, see if I can track an IP
address." -- [[https://www.youtube.com/watch?v=ygB0ZviqXac][Meme]]
#+end_quote

* Learning Resources

1. [[https://learn.microsoft.com/en-us/office/client-developer/excel/excel-home?redirectedfrom=MSDN][Microsoft: Develop solutions and customize Excel]]
2. [[https://learn.microsoft.com/en-us/office/vba/api/overview/excel][Microsoft: Excel VBA Reference]]

* What are Macros?

*Examples:*
+ Automatically formatting a report every time new data is added.
+ Copying and pasting data across sheets without manual effort.
+ Generating and sending automated emails based on Excel data.
+ Importing and cleaning up data from external sources.

* Writing Simple Macros with VBA

Before starting, let's set up Excel for hacking.

1. *Enable the developer menu* at File, Options, Customize Ribbon, and
   enable ~Developer~.
2. *Hit Alt-F11.* This will open the VBA editor.
3. Ensure your file is saved as *xlsm*. If you do not *save as xlsm* all
   of your macros will be lost if you close the file.

Generally in this section we will cover the following:

+ How to record a macro
+ Editing recorded macros in VBA
+ Assigning macros to buttons and shortcuts
+ The Visual Basic for Applications (VBA) editor
+ VBA syntax and structure
+ Variables, data types, and scope
+ Conditional statements (If/Else, Select Case)
+ Loops (For, While, Do Until)

** Recording a Simple Macro

In your sample document (whatever you want) click ~Developer > Record
Macro~, don't bother setting a shortcut, and perform a few actions.
Then hit ~Developer > Stop Recording~.

#+begin_src vba
Sub Macro1()
   '
   ' Macro1 Macro
   ' Set Column Types
   '

   ' Set the column to date format
   Columns("A:A").Select
   Selection.NumberFormat = "m/d/yyyy"
   Columns("A:A").EntireColumn.AutoFit
   ' Set the top item in the column
   Range("A1").Select
   Selection.NumberFormat = "General"
   Selection.Font.Bold = True
End Sub
#+end_src

** Assigning Macros to Buttons

To reassign the macro to another keybinding in the future, you can hit
~Developer > Macros~ and in the ~Options~ for your macro edit the shortcut
and description.

Form buttons can be added to sheets with ~Developer > Insert > Button
(Form Control)~ - clicking the button will then run the macro.


** The Visual Basic for Applications (VBA) editor
** VBA syntax and structure
** Variables, data types, and scope
** Conditional statements (If/Else, Select Case)
** Loops (For, While, Do Until)

* Manipulating Tables in VBA

+ The Object Model (Workbooks, Worksheets, Ranges)
+ Selecting, copying, and formatting cells
+ Manipulating rows, columns, and tables

** The Object Model (Workbooks, Worksheets, Ranges)
** Selecting, copying, and formatting cells
** Manipulating rows, columns, and tables

* Power Automate

Power Automate is a shiny new toy from Microsoft that enables the easy
creation of macro-style event-driven workflows in the cloud. While not
as powerful as macros, there are a certain number of useful tasks that
can be performed with power automate.

* Footnotes

[fn:1] From [[https://news.ycombinator.com/item?id=40682785][Hacker News]] - "So there's this weird playlist about Excel by Martin Shkreli of all people..."
